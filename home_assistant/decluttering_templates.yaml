# =============================================================================
# Decluttering Card Templates for Muadzin Prayer Times
# =============================================================================
#
# SETUP INSTRUCTIONS:
# 1. Install "Decluttering Card" from HACS
# 2. Add this file to your Home Assistant config folder
# 3. Reference it in your configuration.yaml:
#
#    lovelace:
#      mode: yaml
#      dashboards:
#        lovelace-yaml:
#          mode: yaml
#          title: Home
#          filename: ui-lovelace.yaml
#      resources:
#        - url: /hacsfiles/decluttering-card/decluttering-card.js
#          type: module
#
# 4. In your ui-lovelace.yaml, add at the top:
#
#    decluttering_templates: !include decluttering_templates.yaml
#
# 5. Then use the template anywhere in your dashboard:
#
#    - type: custom:decluttering-card
#      template: muadzin_prayer_card
#
# =============================================================================

muadzin_prayer_card:
  card:
    type: custom:mushroom-template-card
    primary: "{{ states('sensor.next_prayer') | title }} - {{ (states('sensor.time_to_next_azan') | int / 60) | int }}:{{ '%02d' | format(states('sensor.time_to_next_azan') | int % 60) }}"
    secondary: ""
    icon: mdi:mosque
    icon_color: green
    badge_icon: "{{ 'mdi:volume-high' if is_state('binary_sensor.azan_is_playing', 'on') else 'mdi:clock-outline' }}"
    badge_color: "{{ 'red' if is_state('binary_sensor.azan_is_playing', 'on') else 'blue' }}"
    tap_action:
      action: fire-dom-event
      browser_mod:
        service: browser_mod.popup
        data:
          title: "Today's Prayer Times üïå"
          content:
            type: vertical-stack
            cards:
              - type: markdown
                content: |
                  ### Next: {{ states('sensor.next_prayer') | title }} in {{ (states('sensor.time_to_next_azan') | int / 60) | int }}:{{ '%02d' | format(states('sensor.time_to_next_azan') | int % 60) }}
              - type: custom:mushroom-template-card
                primary: "üåÖ Fajr - {{ states('sensor.fajr_prayer_time') | as_timestamp | timestamp_custom('%H:%M', true) }}"
                secondary: ""
                icon: mdi:weather-sunset-up
                icon_color: orange
              - type: custom:mushroom-template-card
                primary: "üåû Dhuhr - {{ states('sensor.dhuhr_prayer_time') | as_timestamp | timestamp_custom('%H:%M', true) }}"
                secondary: ""
                icon: mdi:white-balance-sunny
                icon_color: yellow
              - type: custom:mushroom-template-card
                primary: "üå§Ô∏è Asr - {{ states('sensor.asr_prayer_time') | as_timestamp | timestamp_custom('%H:%M', true) }}"
                secondary: ""
                icon: mdi:weather-partly-cloudy
                icon_color: amber
              - type: custom:mushroom-template-card
                primary: "üåá Maghrib - {{ states('sensor.maghrib_prayer_time') | as_timestamp | timestamp_custom('%H:%M', true) }}"
                secondary: ""
                icon: mdi:weather-sunset-down
                icon_color: deep-orange
              - type: custom:mushroom-template-card
                primary: "üåô Isha - {{ states('sensor.isha_prayer_time') | as_timestamp | timestamp_custom('%H:%M', true) }}"
                secondary: ""
                icon: mdi:weather-night
                icon_color: indigo
              - type: custom:mushroom-template-card
                primary: Azan Status
                secondary: "{{ 'Playing' if is_state('binary_sensor.azan_is_playing', 'on') else 'Stopped' }}"
                icon: mdi:volume-high
                icon_color: "{{ 'red' if is_state('binary_sensor.azan_is_playing', 'on') else 'grey' }}"
              - type: horizontal-stack
                cards:
                  - type: button
                    name: Stop Azan
                    icon: mdi:stop-circle
                    tap_action:
                      action: call-service
                      service: rest_command.muadzin_stop_azan
                  - type: button
                    name: Test Azan
                    icon: mdi:play-circle
                    tap_action:
                      action: call-service
                      service: rest_command.muadzin_trigger_azan

# =============================================================================
# USAGE EXAMPLES
# =============================================================================

# Example 1: Use in any dashboard view
# views:
#   - title: Home
#     cards:
#       - type: custom:decluttering-card
#         template: muadzin_prayer_card

# Example 2: Use multiple times (different dashboards/views)
# views:
#   - title: Main
#     cards:
#       - type: custom:decluttering-card
#         template: muadzin_prayer_card
#   - title: Prayers
#     cards:
#       - type: custom:decluttering-card
#         template: muadzin_prayer_card
